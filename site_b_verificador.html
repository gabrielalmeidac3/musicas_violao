<!DOCTYPE html>
<html>
<head>
  <title>Site B - Verificador</title>
</head>
<body>
  <h1>ğŸ” Site B - Verificando login do Site A...</h1>
  <div id="resultado">Aguardando resposta...</div>

  <iframe id="iframeA" src="https://viocomg.github.io/cursofechadoviolao/site_a_login.html" style="display:none;"></iframe>

  <script>
    console.log("[Site B] Iniciando...");

    const iframe = document.getElementById("iframeA");

    window.addEventListener("message", (event) => {
      console.log("[Site B] ğŸ“© Mensagem recebida de:", event.origin, event.data);
      if (event.data.type === "loginStatus") {
        if (event.data.loggedIn) {
          console.log("[Site B] âœ… UsuÃ¡rio estÃ¡ logado no Site A! UID:", event.data.uid);
          document.getElementById("resultado").innerText = "âœ… Logado no Site A!";
        } else {
          console.log("[Site B] âŒ UsuÃ¡rio NÃƒO estÃ¡ logado no Site A.");
          document.getElementById("resultado").innerText = "âŒ NÃ£o logado no Site A.";
        }
      }
    });

    // Aguarda o carregamento do iframe e envia a solicitaÃ§Ã£o
    iframe.onload = () => {
      console.log("[Site B] âœ… Iframe carregado, enviando solicitaÃ§Ã£o...");
      iframe.contentWindow.postMessage({ type: "checkLogin" }, "*");
    };
  </script>
</body>
</html>
